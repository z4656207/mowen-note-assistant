<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>墨问笔记助手 - 侧边栏</title>
    <link rel="stylesheet" href="sidepanel.css">
</head>

<body>
    <div class="container">
        <!-- 头部 -->
        <header class="header">
            <div class="logo">
                <img src="icons/icon48.png" alt="墨问笔记助手" class="logo-img">
                <h1 class="title">墨问笔记助手</h1>
            </div>
            <div class="header-actions">
                <button id="settingsBtn" class="settings-btn" title="设置">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                    </svg>
                </button>
                <!--
                <button id="toggleModeBtn" class="toggle-mode-btn" title="切换到弹窗模式">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <polyline points="15,3 21,3 21,9"></polyline>
                        <line x1="10" y1="14" x2="21" y2="3"></line>
                    </svg>
                </button>
                -->
            </div>
        </header>

        <!-- 主要内容区域 -->
        <main class="main">
            <!-- 模式提示 -->
            <!--
            <div class="mode-indicator">
                <div class="mode-badge">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="9"></rect>
                        <rect x="14" y="3" width="7" height="5"></rect>
                        <rect x="14" y="12" width="7" height="9"></rect>
                    </svg> 侧边栏模式
                </div>
                <div class="mode-description">
                    点击页面其他位置不会关闭
                </div>
            </div>
            -->
            <!-- 页面信息预览 -->
            <div id="pageInfo" class="page-info">
                <div class="page-title" id="pageTitle">正在获取页面信息...</div>
                <div class="page-url" id="pageUrl"></div>
            </div>

            <!-- 处理模式选择 -->
            <div class="processing-mode">
                <div class="mode-header">
                    <h3>处理模式</h3>
                    <!--<p>选择内容处理方式</p>-->
                </div>
                <div class="mode-options">
                    <label class="mode-option">
                        <input type="radio" name="processingMode" value="ai" checked>
                        <div class="mode-card">
                            <div class="mode-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                </svg>
                            </div>
                            <div class="mode-content">
                                <div class="mode-title">AI智能整理</div>
                                <div class="mode-description">使用AI分析和整理网页内容</div>
                            </div>
                        </div>
                    </label>
                    <label class="mode-option">
                        <input type="radio" name="processingMode" value="clip">
                        <div class="mode-card">
                            <div class="mode-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                                    <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                                </svg>
                            </div>
                            <div class="mode-content">
                                <div class="mode-title">一键剪藏</div>
                                <div class="mode-description">直接保存网页内容，无需AI配置</div>
                            </div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- 通用设置 -->
            <div class="common-settings">
                <div class="setting-item">
                    <label class="toggle-label">
                        <input type="checkbox" id="autoPublishToggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">发布公开笔记</span>
                    </label>
                    <div class="setting-help">
                        关闭后笔记将发布为私有
                    </div>
                </div>
            </div>

            <!-- AI模式设置 -->
            <div id="aiModeSettings" class="mode-settings">
                <div class="setting-item">
                    <label class="toggle-label">
                        <input type="checkbox" id="fullTextModeToggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">全文整理模式</span>
                    </label>
                    <div class="setting-help">
                        开启后将整理全文内容，关闭则生成总结
                    </div>
                </div>

                <div class="setting-item">
                    <label class="toggle-label">
                        <input type="checkbox" id="generateTagsToggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">生成标签</span>
                    </label>
                    <div class="setting-help">
                        开启后AI将为笔记生成相关标签
                    </div>
                </div>

                <!-- 自定义提示词设置 -->
                <div class="custom-prompt-settings">
                    <div class="setting-header">
                        <div class="setting-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 20h9"></path>
                                <path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                            </svg> 自定义提示词
                        </div>
                        <div class="setting-description">
                            添加额外的提示信息来指导AI生成更符合需求的内容
                        </div>
                    </div>

                    <div class="custom-prompt-input">
                        <textarea id="customPromptInput" class="custom-prompt-textarea" placeholder="在此输入自定义提示词，例如：请重点关注技术细节、使用专业术语、突出关键观点等" rows="3" maxlength="500"></textarea>
                        <div class="char-counter">
                            <span id="charCount">0</span>/500
                        </div>
                    </div>
                </div>
            </div>

            <!-- 剪藏模式设置 -->
            <div id="clipModeSettings" class="mode-settings" style="display: none;">
                <!-- 图片处理设置 -->
                <div class="setting-item">
                    <label class="toggle-label">
                        <input type="checkbox" id="includeImagesToggle" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">包含图片</span>
                    </label>
                    <div class="setting-help">
                        开启后将自动提取并上传网页中的图片到笔记
                    </div>
                </div>

                <!-- 图片数量限制设置 -->
                <div class="setting-item image-limit-setting">
                    <div class="setting-label">
                        <span class="setting-text">图片数量限制</span>
                    </div>
                    <div class="number-input-container">
                        <button type="button" class="number-btn" id="imageCountDecrease">-</button>
                        <input type="number" id="imageCountInput" class="number-input" value="10" min="0" max="100">
                        <button type="button" class="number-btn" id="imageCountIncrease">+</button>
                    </div>
                    <div class="setting-help">
                        限制提取的图片数量，有助于控制处理时间和避免配额浪费
                    </div>
                </div>

                <div class="clip-mode-info">
                    <div class="info-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 16v-4"></path>
                            <path d="M12 8h.01"></path>
                        </svg>
                    </div>
                    <div class="info-content">
                        <div class="info-title">一键剪藏模式</div>
                        <div class="info-text">直接保存网页内容并转换为墨问富文本格式，保持原有段落结构和基本格式。支持图片自动上传和位置保持。无需AI配置，仅需墨问API密钥即可使用，完全免费且速度快。</div>
                    </div>
                </div>
            </div>

            <!-- 操作按钮 -->
            <div class="actions">
                <button id="extractBtn" class="btn btn-primary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14,2 14,8 20,8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10,9 9,9 8,9"></polyline>
                    </svg>
                    <span id="extractBtnText">提取并发布到墨问</span>
                </button>

                <button id="cancelBtn" class="btn btn-cancel" style="display: none;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M15 9l-6 6"></path>
                        <path d="M9 9l6 6"></path>
                    </svg>
                    取消任务
                </button>

                <button id="previewBtn" class="btn btn-secondary" style="display: none;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    预览内容
                </button>

                <button id="diagnoseBtn" class="btn btn-secondary" style="display: none;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="2"></circle>
                        <path d="M12 2v4m0 12v4m10-6h-4M6 12H2"></path>
                    </svg>
                    诊断问题
                </button>
            </div>

            <!-- 状态显示 -->
            <div id="status" class="status"></div>

            <!-- 进度指示器 -->
            <div id="progress" class="progress" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <div class="progress-text">正在处理...</div>
            </div>

            <!-- 结果显示 -->
            <div id="result" class="result" style="display: none;">
                <div class="result-header">
                    <h3>处理结果</h3>
                    <button id="closeResult" class="close-btn">×</button>
                </div>
                <div class="result-content" id="resultContent"></div>
            </div>
        </main>

        <!-- 底部 -->
        <footer class="footer">
            <div class="footer-links">
                <a href="#" id="helpLink">使用帮助</a>
                <!-- <a href="#" id="feedbackLink">意见反馈</a> -->
            </div>
        </footer>
    </div>

    <!-- 自定义帮助弹框 -->
    <div id="helpModal" class="help-modal">
        <div class="help-modal-content">
            <div class="help-modal-header">
                <h3 class="help-modal-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg> 使用帮助
                </h3>
                <button class="help-modal-close" id="helpModalClose">×</button>
            </div>
            <div class="help-modal-body" id="helpModalBody">
                <!-- 内容将通过JavaScript动态填充 -->
            </div>
        </div>
    </div>

    <script src="sidepanel.js"></script>
</body>

</html>